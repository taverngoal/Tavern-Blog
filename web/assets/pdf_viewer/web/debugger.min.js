"use strict";var FontInspector=function e(){var e;var t=false;var n="data-font-name";function a(){var e=document.querySelectorAll("div["+n+"]");for(var t=0,a=e.length;t<a;++t){var r=e[t];r.className=""}}function r(){var e=document.querySelectorAll("div["+n+"]");for(var t=0,a=e.length;t<a;++t){var r=e[t];r.className="debuggerHideText"}}function i(e,t){var a=document.querySelectorAll("div["+n+"="+e+"]");for(var r=0,i=a.length;r<i;++r){var l=a[r];l.className=t?"debuggerShowText":"debuggerHideText"}}function l(e){if(!e.target.dataset.fontName||e.target.tagName.toUpperCase()!=="DIV"){return}var t=e.target.dataset.fontName;var n=document.getElementsByTagName("input");for(var a=0;a<n.length;++a){var r=n[a];if(r.dataset.fontName!==t){continue}r.checked=!r.checked;i(t,r.checked);r.scrollIntoView()}}return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function o(){var t=this.panel;t.setAttribute("style","padding: 5px;");var n=document.createElement("button");n.addEventListener("click",r);n.textContent="Refresh";t.appendChild(n);e=document.createElement("div");t.appendChild(e)},cleanup:function d(){e.textContent=""},enabled:false,get active(){return t},set active(e){t=e;if(t){document.body.addEventListener("click",l,true);r()}else{document.body.removeEventListener("click",l,true);a()}},fontAdded:function s(t,n){function a(e,t){var n=document.createElement("table");for(var a=0;a<t.length;a++){var r=document.createElement("tr");var i=document.createElement("td");i.textContent=t[a];r.appendChild(i);var l=document.createElement("td");l.textContent=e[t[a]].toString();r.appendChild(l);n.appendChild(r)}return n}var l=a(t,["name","type"]);var o=t.loadedName;var d=document.createElement("div");var s=document.createElement("span");s.textContent=o;var c=document.createElement("a");if(n){n=/url\(['"]?([^\)"']+)/.exec(n);c.href=n[1]}else if(t.data){n=URL.createObjectURL(new Blob([t.data],{type:t.mimeType}));c.href=n}c.textContent="Download";var p=document.createElement("a");p.href="";p.textContent="Log";p.addEventListener("click",function(e){e.preventDefault();console.log(t)});var u=document.createElement("input");u.setAttribute("type","checkbox");u.dataset.fontName=o;u.addEventListener("click",function(e,t){return function(){i(t,e.checked)}}(u,o));d.appendChild(u);d.appendChild(s);d.appendChild(document.createTextNode(" "));d.appendChild(c);d.appendChild(document.createTextNode(" "));d.appendChild(p);d.appendChild(l);e.appendChild(d);setTimeout(function(){if(this.active){r()}}.bind(this),2e3)}}}();var StepperManager=function t(){var e=[];var t=null;var n=null;var a=null;var r={};return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function i(){var e=this;this.panel.setAttribute("style","padding: 5px;");n=document.createElement("div");a=document.createElement("select");a.addEventListener("change",function(t){e.selectStepper(this.value)});n.appendChild(a);t=document.createElement("div");this.panel.appendChild(n);this.panel.appendChild(t);if(sessionStorage.getItem("pdfjsBreakPoints")){r=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))}},cleanup:function l(){a.textContent="";t.textContent="";e=[]},enabled:false,active:false,create:function o(n){var i=document.createElement("div");i.id="stepper"+n;i.setAttribute("hidden",true);i.className="stepper";t.appendChild(i);var l=document.createElement("option");l.textContent="Page "+(n+1);l.value=n;a.appendChild(l);var o=r[n]||[];var d=new Stepper(i,n,o);e.push(d);if(e.length===1){this.selectStepper(n,false)}return d},selectStepper:function d(t,n){var r;t=t|0;if(n){this.manager.selectPanel(this)}for(r=0;r<e.length;++r){var i=e[r];if(i.pageIndex===t){i.panel.removeAttribute("hidden")}else{i.panel.setAttribute("hidden",true)}}var l=a.options;for(r=0;r<l.length;++r){var o=l[r];o.selected=(o.value|0)===t}},saveBreakPoints:function s(e,t){r[e]=t;sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(r))}}}();var Stepper=function n(){function e(e,t){var n=document.createElement(e);if(t){n.textContent=t}return n}var t=null;function n(e){if(typeof e==="string"){var t=75;return e.length<=t?e:e.substr(0,t)+"..."}if(typeof e!=="object"||e===null){return e}if("length"in e){var a=[],r,i;var l=10;for(r=0,i=Math.min(l,e.length);r<i;r++){a.push(n(e[r]))}if(r<e.length){a.push("...")}return a}var o={};for(var d in e){o[d]=n(e[d])}return o}function a(e,t,n){this.panel=e;this.breakPoint=0;this.nextBreakPoint=null;this.pageIndex=t;this.breakPoints=n;this.currentIdx=-1;this.operatorListIdx=0}a.prototype={init:function r(){var n=this.panel;var a=e("div","c=continue, s=step");var r=e("table");a.appendChild(r);r.cellSpacing=0;var i=e("tr");r.appendChild(i);i.appendChild(e("th","Break"));i.appendChild(e("th","Idx"));i.appendChild(e("th","fn"));i.appendChild(e("th","args"));n.appendChild(a);this.table=r;if(!t){t=Object.create(null);for(var l in PDFJS.OPS){t[PDFJS.OPS[l]]=l}}},updateOperatorList:function i(a){var r=this;function i(){var e=+this.dataset.idx;if(this.checked){r.breakPoints.push(e)}else{r.breakPoints.splice(r.breakPoints.indexOf(e),1)}StepperManager.saveBreakPoints(r.pageIndex,r.breakPoints)}var l=15e3;if(this.operatorListIdx>l){return}var o=document.createDocumentFragment();var d=Math.min(l,a.fnArray.length);for(var s=this.operatorListIdx;s<d;s++){var c=e("tr");c.className="line";c.dataset.idx=s;o.appendChild(c);var p=this.breakPoints.indexOf(s)!==-1;var u=a.argsArray[s]||[];var h=e("td");var v=e("input");v.type="checkbox";v.className="points";v.checked=p;v.dataset.idx=s;v.onclick=i;h.appendChild(v);c.appendChild(h);c.appendChild(e("td",s.toString()));var f=t[a.fnArray[s]];var m=u;if(f==="showText"){var g=u[0];var b=[];var C=[];for(var x=0;x<g.length;x++){var k=g[x];if(typeof k==="object"&&k!==null){C.push(k.fontChar)}else{if(C.length>0){b.push(C.join(""));C=[]}b.push(k)}}if(C.length>0){b.push(C.join(""))}m=[b]}c.appendChild(e("td",f));c.appendChild(e("td",JSON.stringify(n(m))))}if(d<a.fnArray.length){c=e("tr");var E=e("td","...");E.colspan=4;o.appendChild(E)}this.operatorListIdx=a.fnArray.length;this.table.appendChild(o)},getNextBreakPoint:function l(){this.breakPoints.sort(function(e,t){return e-t});for(var e=0;e<this.breakPoints.length;e++){if(this.breakPoints[e]>this.currentIdx){return this.breakPoints[e]}}return null},breakIt:function o(e,t){StepperManager.selectStepper(this.pageIndex,true);var n=this;var a=document;n.currentIdx=e;var r=function(e){switch(e.keyCode){case 83:a.removeEventListener("keydown",r,false);n.nextBreakPoint=n.currentIdx+1;n.goTo(-1);t();break;case 67:a.removeEventListener("keydown",r,false);var i=n.getNextBreakPoint();n.nextBreakPoint=i;n.goTo(-1);t();break}};a.addEventListener("keydown",r,false);n.goTo(e)},goTo:function d(e){var t=this.panel.getElementsByClassName("line");for(var n=0,a=t.length;n<a;++n){var r=t[n];if((r.dataset.idx|0)===e){r.style.backgroundColor="rgb(251,250,207)";r.scrollIntoView()}else{r.style.backgroundColor=null}}}};return a}();var Stats=function a(){var e=[];function t(e){while(e.hasChildNodes()){e.removeChild(e.lastChild)}}function n(t){for(var n=0,a=e.length;n<a;++n){if(e[n].pageNumber===t){return n}}return false}return{id:"Stats",name:"Stats",panel:null,manager:null,init:function a(){this.panel.setAttribute("style","padding: 5px;");PDFJS.enableStats=true},enabled:false,active:false,add:function(a,r){if(!r){return}var i=n(a);if(i!==false){var l=e[i];this.panel.removeChild(l.div);e.splice(i,1)}var o=document.createElement("div");o.className="stats";var d=document.createElement("div");d.className="title";d.textContent="Page: "+a;var s=document.createElement("div");s.textContent=r.toString();o.appendChild(d);o.appendChild(s);e.push({pageNumber:a,div:o});e.sort(function(e,t){return e.pageNumber-t.pageNumber});t(this.panel);for(var c=0,p=e.length;c<p;++c){this.panel.appendChild(e[c].div)}},cleanup:function(){e=[];t(this.panel)}}}();var PDFBug=function r(){var e=300;var t=[];var n=null;return{tools:[FontInspector,StepperManager,Stats],enable:function(e){var t=false,n=this.tools;if(e.length===1&&e[0]==="all"){t=true}for(var a=0;a<n.length;++a){var r=n[a];if(t||e.indexOf(r.id)!==-1){r.enabled=true}}if(!t){n.sort(function(t,a){var r=e.indexOf(t.id);r=r<0?n.length:r;var i=e.indexOf(a.id);i=i<0?n.length:i;return r-i})}},init:function a(){var n=document.createElement("div");n.id="PDFBug";var a=document.createElement("div");a.setAttribute("class","controls");n.appendChild(a);var r=document.createElement("div");r.setAttribute("class","panels");n.appendChild(r);var i=document.getElementById("viewerContainer");i.appendChild(n);i.style.right=e+"px";var l=this.tools;var o=this;for(var d=0;d<l.length;++d){var s=l[d];var c=document.createElement("div");var p=document.createElement("button");p.textContent=s.name;p.addEventListener("click",function(e){return function(t){t.preventDefault();o.selectPanel(e)}}(d));a.appendChild(p);r.appendChild(c);s.panel=c;s.manager=this;if(s.enabled){s.init()}else{c.textContent=s.name+" is disabled. To enable add "+' "'+s.id+'" to the pdfBug parameter '+"and refresh (seperate multiple by commas)."}t.push(p)}this.selectPanel(0)},cleanup:function r(){for(var e=0,t=this.tools.length;e<t;e++){if(this.tools[e].enabled){this.tools[e].cleanup()}}},selectPanel:function i(e){if(typeof e!=="number"){e=this.tools.indexOf(e)}if(e===n){return}n=e;var a=this.tools;for(var r=0;r<a.length;++r){if(r===e){t[r].setAttribute("class","active");a[r].active=true;a[r].panel.removeAttribute("hidden")}else{t[r].setAttribute("class","");a[r].active=false;a[r].panel.setAttribute("hidden","true")}}}}}();